<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Документы - Маркаров Михаил</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .documents-page {
            padding-top: 100px;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            background: #000000;
        }
        
        #starsCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        
        .documents-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        /* File manager layout */
        .documents-fm {
            display: flex;
            gap: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            min-height: 60vh;
            margin-bottom: 2rem;
        }
        
        .documents-sidebar {
            width: 240px;
            min-width: 240px;
            background: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
        }
        
        .documents-sidebar-title {
            padding: 12px 16px;
            font-weight: 600;
            color: var(--accent);
            border-bottom: 1px solid var(--border-color);
        }
        
        .documents-folder {
            padding: 10px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-secondary);
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }
        
        .documents-folder:hover {
            background: rgba(139, 92, 246, 0.1);
            color: var(--text-primary);
        }
        
        .documents-folder.active {
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent);
            border-left-color: var(--accent);
        }
        
        .documents-folder i {
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }
        
        .documents-folder .count {
            margin-left: auto;
            font-size: 0.8rem;
            opacity: 0.7;
        }
        
        .documents-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .documents-toolbar {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
        }
        
        .documents-search {
            flex: 1;
            max-width: 400px;
            padding: 10px 16px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }
        
        .documents-search::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }
        
        .documents-search:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .documents-view-toggle {
            display: flex;
            gap: 4px;
        }
        
        .documents-view-toggle button {
            padding: 8px 12px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .documents-view-toggle button:hover {
            color: var(--accent);
            border-color: var(--accent);
        }
        
        .documents-view-toggle button.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        
        .documents-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }
        
        /* List view - table */
        .documents-list {
            width: 100%;
            border-collapse: collapse;
        }
        
        .documents-list th {
            text-align: left;
            padding: 12px 16px;
            color: var(--accent);
            font-weight: 600;
            background: var(--bg-primary);
            border-bottom: 2px solid var(--border-color);
        }
        
        .documents-list td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .documents-list tr:hover td {
            background: rgba(139, 92, 246, 0.08);
        }
        
        .documents-list .doc-col-icon {
            width: 40px;
            text-align: center;
        }
        
        .documents-list .doc-col-icon i {
            font-size: 1.4rem;
            color: var(--accent);
        }
        
        .documents-list .doc-col-name {
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .documents-list .doc-col-type {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .documents-list .doc-col-actions {
            text-align: right;
        }
        
        .documents-list a.doc-link {
            color: var(--accent);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .documents-list a.doc-link:hover {
            color: var(--accent-hover);
            text-decoration: underline;
        }
        
        /* Grid view - compact cards */
        .documents-grid-inner {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        
        .documents-grid-inner.view-large {
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }
        
        .document-card {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 14px;
            transition: all 0.2s;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 120px;
            text-decoration: none;
            color: inherit;
        }
        
        .document-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.2);
        }
        
        .document-card .document-icon {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 8px;
        }
        
        .document-card.view-large .document-icon {
            font-size: 3rem;
        }
        
        .document-card h3 {
            font-size: 0.85rem;
            margin: 0;
            color: var(--text-primary);
            line-height: 1.3;
            word-break: break-word;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .document-card.view-large h3 {
            font-size: 0.95rem;
        }
        
        .document-card .doc-download {
            margin-top: 8px;
            padding: 6px 12px;
            font-size: 0.8rem;
            background: var(--accent);
            color: white;
            border-radius: 6px;
            text-decoration: none;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .document-card:hover .doc-download {
            opacity: 1;
        }
        
        .documents-category {
            margin-bottom: 1.5rem;
        }
        
        .documents-category-header {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--bg-primary);
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            user-select: none;
            transition: background 0.2s;
            border: 1px solid var(--border-color);
        }
        
        .documents-category-header:hover {
            background: rgba(139, 92, 246, 0.1);
        }
        
        .documents-category-header .toggle-icon {
            transition: transform 0.2s;
        }
        
        .documents-category-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .documents-category-title {
            font-size: 1.1rem;
            color: var(--accent);
            font-weight: 600;
            flex: 1;
        }
        
        .documents-category-header .doc-count {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .documents-category-body {
            max-height: 3000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .documents-category-body.collapsed {
            max-height: 0 !important;
            overflow: hidden;
            margin-bottom: 0;
        }
        
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
            grid-column: 1 / -1;
        }
        
        .empty-state i {
            font-size: 5rem;
            color: var(--accent);
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .empty-state code {
            background: var(--bg-secondary);
            padding: 0.2em 0.5em;
            border-radius: 4px;
            font-size: 0.9em;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 2rem;
            color: var(--accent);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .back-link:hover {
            color: var(--accent-hover);
            transform: translateX(-5px);
        }
        
        @media (max-width: 768px) {
            .documents-fm {
                flex-direction: column;
            }
            
            .documents-sidebar {
                width: 100%;
                min-width: 100%;
                max-height: 200px;
            }
            
            .documents-grid-inner {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">Маркаров Михаил Оганесович</div>
                <ul class="nav-menu">
                    <li><a href="index.html#home" class="nav-link">Главная</a></li>
                    <li><a href="index.html#about" class="nav-link">О себе</a></li>
                    <li><a href="index.html#services" class="nav-link">Услуги</a></li>
                    <li><a href="index.html#experience" class="nav-link">Опыт</a></li>
                    <li><a href="index.html#contact" class="nav-link">Контакты</a></li>
                    <li><a href="documents.html" class="nav-link">Документы</a></li>
                </ul>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Documents Section -->
    <section class="documents-page">
        <canvas id="starsCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none;"></canvas>
        <div class="container" style="position: relative; z-index: 1;">
            <div class="documents-header">
                <h1 class="section-title">Документы и <span class="highlight">Сертификаты</span></h1>
                <p style="color: var(--text-secondary); margin-top: 0.5rem;">
                    PDF, DOCX и другие материалы — удобная навигация как в проводнике
                </p>
            </div>

            <div class="documents-fm">
                <aside class="documents-sidebar" id="documentsSidebar">
                    <div class="documents-sidebar-title"><i class="fas fa-folder"></i> Разделы</div>
                    <div id="documentsCategories"></div>
                </aside>
                <main class="documents-main">
                    <div class="documents-toolbar">
                        <input type="text" class="documents-search" id="documentsSearch" placeholder="Поиск по названию документа...">
                        <div class="documents-view-toggle">
                            <button type="button" id="viewList" class="active" title="Список"><i class="fas fa-list"></i></button>
                            <button type="button" id="viewGrid" title="Плитка"><i class="fas fa-th-large"></i></button>
                        </div>
                    </div>
                    <div class="documents-content" id="documentsGrid">
                        <div class="empty-state">
                            <i class="fas fa-file-pdf"></i>
                            <h3>Документы скоро появятся</h3>
                            <p>Загрузите PDF файлы в папку documents/ для их автоматического отображения</p>
                        </div>
                    </div>
                </main>
            </div>

            <div style="text-align: center;">
                <a href="index.html" class="back-link">
                    <i class="fas fa-arrow-left"></i> Вернуться на главную
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>Copyright © 2026 by Михаил Маркаров. All Rights Reserved.</p>
            <button class="scroll-top" id="scrollTop">
                <i class="fas fa-arrow-up"></i>
            </button>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        const DOCUMENTS_FOLDER = 'documents/';

        /** Показать инструкцию, если папки documents/ нет или список пуст */
        function showNoDocumentsInstruction(grid) {
            grid.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-folder-open"></i>
                    <h3>Документы не найдены</h3>
                    <p>Создайте папку <code>documents/</code> в корне портфолио, поместите туда PDF-файлы и запустите скрипт <code>node update-documents.js</code> для обновления списка.</p>
                    <p style="margin-top: 1rem; font-size: 0.9rem;">Либо добавьте вручную файл <code>documents-list.json</code> с массивом <code>documents: [{ "filename": "имя.pdf", "name": "Название" }]</code>.</p>
                </div>
            `;
        }

        /** Кодирование пути с русскими именами */
        function encodeDocumentPath(filename) {
            return DOCUMENTS_FOLDER + filename.split('/').map(encodeURIComponent).join('/');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function getFileType(filename) {
            const ext = (filename.match(/\.([^.]+)$/) || [])[1] || '';
            return ext.toUpperCase();
        }

        function getFileIcon(filename) {
            if (/\.pdf$/i.test(filename)) return 'fa-file-pdf';
            if (/\.docx?$/i.test(filename)) return 'fa-file-word';
            return 'fa-file';
        }

        /** Компактная карточка для сетки */
        function createDocumentCard(doc, viewLarge) {
            const encodedPath = encodeDocumentPath(doc.filename);
            const fileName = doc.name || doc.filename.replace(/\.[^.]+$/, '').replace(/_/g, ' ');
            const iconClass = getFileIcon(doc.filename);
            const card = document.createElement('a');
            card.className = 'document-card' + (viewLarge ? ' view-large' : '');
            card.href = encodedPath;
            card.target = '_blank';
            card.rel = 'noopener';
            card.download = !/\.pdf$/i.test(doc.filename);
            card.innerHTML = `
                <div class="document-icon"><i class="fas ${iconClass}"></i></div>
                <h3>${escapeHtml(fileName)}</h3>
                <span class="doc-download"><i class="fas fa-download"></i> Скачать</span>
            `;
            return card;
        }

        /** Строка таблицы для списка */
        function createDocumentRow(doc) {
            const encodedPath = encodeDocumentPath(doc.filename);
            const fileName = doc.name || doc.filename.replace(/\.[^.]+$/, '').replace(/_/g, ' ');
            const type = getFileType(doc.filename);
            const iconClass = getFileIcon(doc.filename);
            const tr = document.createElement('tr');
            tr.dataset.category = escapeHtml(doc.category || 'Прочее');
            tr.innerHTML = `
                <td class="doc-col-icon"><i class="fas ${iconClass}"></i></td>
                <td class="doc-col-name">${escapeHtml(fileName)}</td>
                <td class="doc-col-type">${escapeHtml(doc.category || 'Прочее')}</td>
                <td class="doc-col-type">${escapeHtml(type)}</td>
                <td class="doc-col-actions">
                    <a href="${escapeHtml(encodedPath)}" target="_blank" rel="noopener" class="doc-link" ${!/\.pdf$/i.test(doc.filename) ? 'download' : ''}>
                        <i class="fas fa-external-link-alt"></i> Открыть
                    </a>
                </td>
            `;
            return tr;
        }

        let documentsData = { documents: [], byCategory: {}, categoriesOrder: [] };
        let currentView = 'list';
        let currentFilter = '';

        async function loadDocuments() {
            const documentsGrid = document.getElementById('documentsGrid');
            const categoriesEl = document.getElementById('documentsCategories');
            if (!documentsGrid || !categoriesEl) return;

            try {
                const response = await fetch('documents-list.json');
                if (!response.ok) throw new Error('HTTP ' + response.status);
                const data = await response.json();
                const documents = data.documents || [];
                const categoriesOrder = data.categoriesOrder || [];

                if (documents.length === 0) {
                    showNoDocumentsInstruction(documentsGrid);
                    return;
                }

                const byCategory = {};
                documents.forEach(function (doc) {
                    const cat = doc.category || 'Прочее';
                    if (!byCategory[cat]) byCategory[cat] = [];
                    byCategory[cat].push(doc);
                });

                const categoriesToShow = categoriesOrder.length ? categoriesOrder : Object.keys(byCategory);
                documentsData = { documents, byCategory, categoriesOrder: categoriesToShow };

                // Боковая панель категорий
                categoriesEl.innerHTML = '';
                const allItem = document.createElement('div');
                allItem.className = 'documents-folder active';
                allItem.dataset.category = '';
                allItem.innerHTML = '<i class="fas fa-folder-open"></i><span>Все документы</span><span class="count">' + documents.length + '</span>';
                allItem.onclick = () => filterByCategory('');
                categoriesEl.appendChild(allItem);

                categoriesToShow.forEach(function (cat) {
                    const list = byCategory[cat];
                    if (!list || list.length === 0) return;
                    const div = document.createElement('div');
                    div.className = 'documents-folder';
                    div.dataset.category = cat;
                    div.innerHTML = '<i class="fas fa-folder"></i><span>' + escapeHtml(cat) + '</span><span class="count">' + list.length + '</span>';
                    div.onclick = () => filterByCategory(cat);
                    categoriesEl.appendChild(div);
                });

                renderDocuments();
                setupSearchAndView();
            } catch (error) {
                console.error('Ошибка загрузки списка документов:', error);
                showNoDocumentsInstruction(documentsGrid);
            }
        }

        function filterByCategory(cat) {
            currentFilter = cat;
            document.querySelectorAll('.documents-folder').forEach(el => {
                el.classList.toggle('active', (el.dataset.category || '') === (cat || ''));
            });
            renderDocuments();
        }

        function setupSearchAndView() {
            const search = document.getElementById('documentsSearch');
            const viewList = document.getElementById('viewList');
            const viewGrid = document.getElementById('viewGrid');

            if (search) {
                search.oninput = () => renderDocuments();
            }
            if (viewList) viewList.onclick = () => { currentView = 'list'; viewList.classList.add('active'); viewGrid.classList.remove('active'); renderDocuments(); };
            if (viewGrid) viewGrid.onclick = () => { currentView = 'grid'; viewGrid.classList.add('active'); viewList.classList.remove('active'); renderDocuments(); };
        }

        function renderDocuments() {
            const documentsGrid = document.getElementById('documentsGrid');
            if (!documentsGrid) return;

            const q = (document.getElementById('documentsSearch')?.value || '').toLowerCase().trim();
            const cat = currentFilter;
            const byCategory = documentsData.byCategory || {};
            const categoriesOrder = documentsData.categoriesOrder || [];

            let hasContent = false;
            documentsGrid.innerHTML = '';

            if (currentView === 'list') {
                const table = document.createElement('table');
                table.className = 'documents-list';
                table.innerHTML = '<thead><tr><th class="doc-col-icon"></th><th>Название</th><th>Раздел</th><th>Тип</th><th class="doc-col-actions">Действия</th></tr></thead><tbody></tbody>';
                const tbody = table.querySelector('tbody');

                categoriesOrder.forEach(function (categoryTitle) {
                    if (cat && cat !== categoryTitle) return;
                    const list = (byCategory[categoryTitle] || []).filter(d => !q || (d.name || '').toLowerCase().includes(q) || (d.filename || '').toLowerCase().includes(q));
                    list.forEach(doc => { tbody.appendChild(createDocumentRow(doc)); hasContent = true; });
                });

                documentsGrid.appendChild(table);
            } else {
                categoriesOrder.forEach(function (categoryTitle) {
                    if (cat && cat !== categoryTitle) return;
                    const list = (byCategory[categoryTitle] || []).filter(d => !q || (d.name || '').toLowerCase().includes(q) || (d.filename || '').toLowerCase().includes(q));
                    if (list.length === 0) return;

                    hasContent = true;
                    const section = document.createElement('div');
                    section.className = 'documents-category';
                    const header = document.createElement('div');
                    header.className = 'documents-category-header';
                    header.innerHTML = '<i class="fas fa-chevron-down toggle-icon"></i><span class="documents-category-title">' + escapeHtml(categoryTitle) + '</span><span class="doc-count">' + list.length + '</span>';
                    const body = document.createElement('div');
                    body.className = 'documents-category-body';
                    const grid = document.createElement('div');
                    grid.className = 'documents-grid-inner';

                    list.forEach(doc => grid.appendChild(createDocumentCard(doc, false)));
                    body.appendChild(grid);
                    section.appendChild(header);
                    section.appendChild(body);
                    documentsGrid.appendChild(section);

                    header.onclick = () => { header.classList.toggle('collapsed'); body.classList.toggle('collapsed'); };
                });
            }

            if (!hasContent) {
                documentsGrid.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><h3>Ничего не найдено</h3><p>Попробуйте изменить поисковый запрос или выберите другой раздел</p></div>';
            }
        }
        
        
        // Animated Stars Background
        function initStars() {
            const canvas = document.getElementById('starsCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let stars = [];
            let animationId;
            
            function resizeCanvas() {
                const dpr = window.devicePixelRatio || 1;
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width * dpr;
                canvas.height = rect.height * dpr;
                canvas.style.width = rect.width + 'px';
                canvas.style.height = rect.height + 'px';
                ctx.scale(dpr, dpr);
                
                // Recreate stars on resize
                createStars();
            }
            
            function createStars() {
                const width = canvas.offsetWidth;
                const height = canvas.offsetHeight;
                const numStars = Math.floor((width * height) / 15000); // Плотность звезд
                
                stars = [];
                for (let i = 0; i < numStars; i++) {
                    stars.push({
                        x: Math.random() * width,
                        y: Math.random() * height,
                        radius: Math.random() * 1.5 + 0.5,
                        opacity: Math.random() * 0.8 + 0.2,
                        pulseSpeed: Math.random() * 0.02 + 0.01,
                        pulsePhase: Math.random() * Math.PI * 2,
                        twinkleSpeed: Math.random() * 0.03 + 0.01,
                        twinklePhase: Math.random() * Math.PI * 2
                    });
                }
            }
            
            function drawStars() {
                const width = canvas.offsetWidth;
                const height = canvas.offsetHeight;
                
                ctx.clearRect(0, 0, width, height);
                
                stars.forEach(star => {
                    // Пульсация размера
                    star.pulsePhase += star.pulseSpeed;
                    const pulseSize = star.radius + Math.sin(star.pulsePhase) * 0.3;
                    
                    // Мерцание прозрачности
                    star.twinklePhase += star.twinkleSpeed;
                    const twinkleOpacity = star.opacity + Math.sin(star.twinklePhase) * 0.3;
                    const finalOpacity = Math.max(0.1, Math.min(1, twinkleOpacity));
                    
                    // Рисуем звезду
                    ctx.beginPath();
                    ctx.arc(star.x, star.y, pulseSize, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${finalOpacity})`;
                    ctx.fill();
                    
                    // Добавляем свечение для ярких звезд
                    if (finalOpacity > 0.6) {
                        ctx.shadowBlur = 5;
                        ctx.shadowColor = 'rgba(255, 255, 255, 0.5)';
                        ctx.fill();
                        ctx.shadowBlur = 0;
                    }
                });
                
                animationId = requestAnimationFrame(drawStars);
            }
            
            // Инициализация
            resizeCanvas();
            window.addEventListener('resize', () => {
                resizeCanvas();
            });
            
            // Начать анимацию
            drawStars();
        }
        
        // Load documents on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadDocuments();
            initStars();
        });
    </script>
</body>
</html>
